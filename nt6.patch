diff --git a/.nvmrc b/.nvmrc
index 48b14e6..c85fa1b 100644
--- a/.nvmrc
+++ b/.nvmrc
@@ -1 +1 @@
-20.16.0
+18.18.2
diff --git a/.npmrc b/.npmrc
index 87dc701..4e8e481 100644
--- a/.npmrc
+++ b/.npmrc
@@ -1,5 +1,5 @@
 disturl="https://electronjs.org/headers"
-target="30.5.1"
+target="28.3.3"
 ms_build_id="10262041"
 runtime="electron"
 build_from_source="true"
diff --git a/build/checksums/electron.txt b/build/checksums/electron.txt
index 5365421..9ecb134 100644
--- a/build/checksums/electron.txt
+++ b/build/checksums/electron.txt
@@ -1,75 +1,75 @@
-3de7da4462c7690f75680aecac8fddedc4b998d0da769136d8eff2932b36004e *chromedriver-v30.5.1-darwin-arm64.zip
-d89b89f7c2ba45cb10df7fc23722bacf6f77e13002c42648762cd18ae3fa9182 *chromedriver-v30.5.1-darwin-x64.zip
-3722d46929fd2c7b33c17d37464a08150e60d9269053eb67195795254fb5e947 *chromedriver-v30.5.1-linux-arm64.zip
-a786d51f834c24b768bd415bf9a2fc5c1d9abdf9dc0b1a091bf9a8ff101becfe *chromedriver-v30.5.1-linux-armv7l.zip
-688e4da8dbcb7dbfacab6f29341d96736e6d06e4c8029835b83ef30b69885b01 *chromedriver-v30.5.1-linux-x64.zip
-786a7c2659ad97d5a09866b9aafd55edc015cb17a87bd8d72aa5925f2bfcf55a *chromedriver-v30.5.1-mas-arm64.zip
-398759d1dc02fc4928d48ff0f8fbade8811347e1a51d1cedcb2ba9350fbed04d *chromedriver-v30.5.1-mas-x64.zip
-65766f1270d1876e2a81acfb4b1130dc4a41eb7165842afa8f41ea438bf2fecb *chromedriver-v30.5.1-win32-arm64.zip
-ca9fe0abd1032ebd51497049cb1bb2ae1dd9592697b278f6b1ee2a1a25148891 *chromedriver-v30.5.1-win32-ia32.zip
-b6b6ea2202e0139ea436288add736d19078bfb190fc0b22937283927f3024bb9 *chromedriver-v30.5.1-win32-x64.zip
-50e8b2d59916bc180873324fdbeb8227dbb8b2375cc936e58b7c9885fb23376d *electron-api.json
-595db4fa3f755432bf59cbbaf591ee44b576e15952d014d83d3748646b2e338c *electron-v30.5.1-darwin-arm64-dsym-snapshot.zip
-c1beb80553f3c9575e638625ce0ffbfdb87b6f8b23799eb132954b2bb74a9a2f *electron-v30.5.1-darwin-arm64-dsym.zip
-cba315d6d6f607a2ee6cfc437b46f92da88daded86f0130d85129adb4742bc48 *electron-v30.5.1-darwin-arm64-symbols.zip
-d312544ea29844cf328b44b9dbde12f4fdced90cb442dfca6df36c098dbb6e7a *electron-v30.5.1-darwin-arm64.zip
-fd24d585d28909c082d703db3fcc5ffa0b55e1077ff320e25ed510f36e6a3761 *electron-v30.5.1-darwin-x64-dsym-snapshot.zip
-4d1a2adea4b98c4d0b03c6561fca146aab102d636d359e48ce418c465df891ae *electron-v30.5.1-darwin-x64-dsym.zip
-d9065eaf659f4c3e8a75f5453ceb65269763b2e57110bdcc01904b9a1e33a62c *electron-v30.5.1-darwin-x64-symbols.zip
-faf9dcc20d525607ea205f2f6a1dfe3270f6268aa439bb0ba5646c7e4fbbd842 *electron-v30.5.1-darwin-x64.zip
-b85dba1cdb49591542dcecff3e710f29b81285569c8c5db8c1181c3ed818ba44 *electron-v30.5.1-linux-arm64-debug.zip
-5e97cc105282783d1c20d8e8dd4ca1134342839235288840cb50f314ca7a6ede *electron-v30.5.1-linux-arm64-symbols.zip
-eb31470c0d7cd6e23e7ce0d89cc93a2356c9dac8bcc997e335353b8aa995afa0 *electron-v30.5.1-linux-arm64.zip
-b85dba1cdb49591542dcecff3e710f29b81285569c8c5db8c1181c3ed818ba44 *electron-v30.5.1-linux-armv7l-debug.zip
-137548cd73cd648107f6e01c777e411838173309848a492b42825857cec7d110 *electron-v30.5.1-linux-armv7l-symbols.zip
-224bd46983e503101c756c72d10b195f14712a7a56438718acb126017dd04edf *electron-v30.5.1-linux-armv7l.zip
-1f87fadebc444c9c0de43f52972a3f61af83ca0594c3de368f7579ce613fcb60 *electron-v30.5.1-linux-x64-debug.zip
-aae78654f599a68310bdbdc0e3de8db644320ef44e58a5c6e5c693dff5cd1970 *electron-v30.5.1-linux-x64-symbols.zip
-ec4707783d39e86005f42899e30ae59e50dd5d9c7f28531ed494eb43f2361403 *electron-v30.5.1-linux-x64.zip
-c61f3121e52fd29987814b7805b597ef3fc78b2ce891eba5e3fc6bbe14128f23 *electron-v30.5.1-mas-arm64-dsym-snapshot.zip
-f934e55ef6c986d3ec56626b2605fed16030efc45efcd8b05afa9322d625ec56 *electron-v30.5.1-mas-arm64-dsym.zip
-3cc36e99f2cd59d7cb2f47b52d19609c2a2358f6ddde35fd832872abe241cc8d *electron-v30.5.1-mas-arm64-symbols.zip
-c5085ab1fb74dfa4a4e463dcb688989bc63baf44007419fd96db4e7c974fb6db *electron-v30.5.1-mas-arm64.zip
-47102b6dcd5892de734be2b48e40bbbdbc5e0a228bf5fec33071661d2724d946 *electron-v30.5.1-mas-x64-dsym-snapshot.zip
-607091ddfd313ed27bb5a0acb6fa58b0d65cb87e6c6ce9b373949b4b152476d8 *electron-v30.5.1-mas-x64-dsym.zip
-ac49568635d41e1075bca39c97aca1f2fcede702f721ddce5d80f18cc2dd1067 *electron-v30.5.1-mas-x64-symbols.zip
-3746bc4ba32ab9c11398a393d54ba81733088729ae7cef4e5dccf1e64dc82b0a *electron-v30.5.1-mas-x64.zip
-930ad941c8bc0aa5e4e3457b235f104846939974d71bde5b42a8980de2d4a35d *electron-v30.5.1-win32-arm64-pdb.zip
-11c1252547b381ab6e40cc032ee60c5209dee9ea1102d1b47ad3fcd4da03049f *electron-v30.5.1-win32-arm64-symbols.zip
-7351fa5cb892853a7d4b67d8858d0f9cc6506c554a2e42c9ad7e8d5e29ae2743 *electron-v30.5.1-win32-arm64-toolchain-profile.zip
-f18baa98ba9c04b346fda9f40fc3150a57b539d0cd510971a073983f78e0a20c *electron-v30.5.1-win32-arm64.zip
-b03c7297dc61aa234ab2273c419d9ae064e52c2c0c3dd56f09135f81964630b5 *electron-v30.5.1-win32-ia32-pdb.zip
-8fc570c7f4d97eb6b745fb4af5932311d1da57058da8f39a3d97d6e099cd6982 *electron-v30.5.1-win32-ia32-symbols.zip
-7351fa5cb892853a7d4b67d8858d0f9cc6506c554a2e42c9ad7e8d5e29ae2743 *electron-v30.5.1-win32-ia32-toolchain-profile.zip
-20845163bf9d5a4ead03c5f0280c9bae71f0ab1fc03362f3406ed12620e4d9cd *electron-v30.5.1-win32-ia32.zip
-019f3ae97a69dc837d89c44d25e0e5dadc88564b74202c5a3524fc6ab59490bc *electron-v30.5.1-win32-x64-pdb.zip
-2eb4889fe275e5ea42cf6f51821bcceb833d5714aa1b45ad7915495afb447e94 *electron-v30.5.1-win32-x64-symbols.zip
-7351fa5cb892853a7d4b67d8858d0f9cc6506c554a2e42c9ad7e8d5e29ae2743 *electron-v30.5.1-win32-x64-toolchain-profile.zip
-443119bb559fc2ca297a57cf79f2bce532e853ada070c1e71460c9657c13b4b3 *electron-v30.5.1-win32-x64.zip
-deecdc1f3f5ea9548ef73774f412c7af489afeb7dca1c394b5add10e929aff42 *electron.d.ts
-14319b51118a5c94e108731f6b5c4e701c700212e790198ba22242eb9674a334 *ffmpeg-v30.5.1-darwin-arm64.zip
-bfd5110457438fa8b113a8806db45f30b8975304d95e5efb1b71b0f5e46757fe *ffmpeg-v30.5.1-darwin-x64.zip
-44ebf3185fc24404647da0c1f9e496effefd32ff3dbc2499c022164b919d06ed *ffmpeg-v30.5.1-linux-arm64.zip
-4f7583513d48b48c44a2cbc4430cbc9a33d8f9728622166db688e3de61190821 *ffmpeg-v30.5.1-linux-armv7l.zip
-154900e5db5810f63e38fd4551cfff3d88d6eac39226e06e12e1e43558d360a4 *ffmpeg-v30.5.1-linux-x64.zip
-14319b51118a5c94e108731f6b5c4e701c700212e790198ba22242eb9674a334 *ffmpeg-v30.5.1-mas-arm64.zip
-bfd5110457438fa8b113a8806db45f30b8975304d95e5efb1b71b0f5e46757fe *ffmpeg-v30.5.1-mas-x64.zip
-f2169c4b6b9f073c20652953599f2453947936e851ff25c9f2719e7d889faea3 *ffmpeg-v30.5.1-win32-arm64.zip
-90745f1422ae0431b295cb5d27ff03e69c890f3572ef6c4655774b892419e94f *ffmpeg-v30.5.1-win32-ia32.zip
-567fe8952f17b224d4492980af741b470e86b31d58e7c6a9262258eeae490122 *ffmpeg-v30.5.1-win32-x64.zip
-8bbbadb52a19f074d9f8bd533891e2bacbe4813101ae6c344cfc88e28b1429a3 *hunspell_dictionaries.zip
-61137508aee6837c70a2ead2e31dd106d753ec5fac01b49e7e8701be0e09e7aa *libcxx-objects-v30.5.1-linux-arm64.zip
-3c285f012f256f767e777550a1f18054cfcffc4e13ad6fa4e4e90dd58ec22069 *libcxx-objects-v30.5.1-linux-armv7l.zip
-9b96b53c8dfbc70a0f617f78dde89a1e8510ae2261bcddfbf7c12c61eb5a3d73 *libcxx-objects-v30.5.1-linux-x64.zip
-1b5cbe24d6356a388e166bff60d7452583019ea7dec85f593c552eb287346f43 *libcxx_headers.zip
-eae200a0d1fd0d4b881358bdef600111891c75ecc4db679b680b0cbaf87ecfc3 *libcxxabi_headers.zip
-ed1f7463b5869acf57dd388208918652182b049b2846f572d52ed47e7c091d54 *mksnapshot-v30.5.1-darwin-arm64.zip
-bc80de1f29b869cdb2676d2dc08cbb4bd6228a6825b1b0bfc13acee0b070ac3e *mksnapshot-v30.5.1-darwin-x64.zip
-5e526ca4f4250a9b9b040d6eb60f1d2b8db974ab68c27e46198f4bf8dc1ef347 *mksnapshot-v30.5.1-linux-arm64-x64.zip
-c40ca2a45cc9ab4e1668f063860ba243baef8c192a253638e4c93aaccb0ef8da *mksnapshot-v30.5.1-linux-armv7l-x64.zip
-a3134e0b0980547167dd3ca2f17dd2f40a7db697ab563ba6257534f9ad0d256d *mksnapshot-v30.5.1-linux-x64.zip
-82776eafcb3e4d053e275ad50d84151f41a651986baacda20c6ed722854cb8fb *mksnapshot-v30.5.1-mas-arm64.zip
-9d6d95d4cb121a29fd68d64557edd8c9859345ac37d0645de8aff518391755ed *mksnapshot-v30.5.1-mas-x64.zip
-94b9ce6cb40ae001962b77525d12483c3458776066a69a4e714b327bab1decfc *mksnapshot-v30.5.1-win32-arm64-x64.zip
-4d89d06c2e85b25d52bb64f48258ad5d05b98ac21697ae9c49ccd19bad9d7d94 *mksnapshot-v30.5.1-win32-ia32.zip
-ccfd322bafde0485a0ac6b0acc3669c7b08f30003a1c2e044eebc1bf02289de3 *mksnapshot-v30.5.1-win32-x64.zip
+2a623f1ad98c60c7f47b13301cec44941279771e675f2ec89027f26e1ee52678 *chromedriver-v28.3.3-darwin-arm64.zip
+3cbb0bafefca106477943c5d9d2463d0fa5fa6ef6ea5d55efe44dd814eb3a3e7 *chromedriver-v28.3.3-darwin-x64.zip
+c9d8092bb21198fc90eba452233871d81d1b549c3505e4fbd505eca61ce2c294 *chromedriver-v28.3.3-linux-arm64.zip
+5ea3a62da4e0c44de8a498eaca963849daffe8e96128fb9d9d52ca254e6072bc *chromedriver-v28.3.3-linux-armv7l.zip
+5272607001d4294d536e5ebdc6a10555557bd81b905bebe89b128e2c3ec106a5 *chromedriver-v28.3.3-linux-x64.zip
+c3e82eccc77c0c52d2cf8853ffdbd8c61ff25d6b2eaa0e2d1070e2fb62af1ff5 *chromedriver-v28.3.3-mas-arm64.zip
+7d47a5cc056ab9dddd3d4e1f450cc1bbaa824390e6a1e971e4b0d142e52f4982 *chromedriver-v28.3.3-mas-x64.zip
+45ee23f9450b68df9f802121eaec4cfc2658eba2214611e8fdc4464e4baff907 *chromedriver-v28.3.3-win32-arm64.zip
+cc6199a4f5e8e52836f627febec9b83fd1eebfeef234597e5c6eb988f51b66a5 *chromedriver-v28.3.3-win32-ia32.zip
+dd78f8914aa17eeabcb575872ca51fca900c514f070219370ca0267e91129665 *chromedriver-v28.3.3-win32-x64.zip
+e53cf1d2b836a15fec89b479e2b9cc600086c9d841482a0418944e54cda391be *electron-api.json
+72b8c08c8675dcf045a31e84e4579fda4329abbe98be9a0dedadb6cc51d5e67c *electron-v28.3.3-darwin-arm64-dsym-snapshot.zip
+604a7742068ce33f9da4b058add0a1a6ca033aef6ea40fbfd4438b04195b015e *electron-v28.3.3-darwin-arm64-dsym.zip
+371f8cebebd745147026a7a21ab1552f2f153e58e99c2e47c64a4dde2ed06e3e *electron-v28.3.3-darwin-arm64-symbols.zip
+c310ab098d8849c4aa05f05b1c8521031241a046e023a911f964fd1db31c64c9 *electron-v28.3.3-darwin-arm64.zip
+56d76484ce86963af476a075a753232b3e590a17590f8dea80bca17282d27c6f *electron-v28.3.3-darwin-x64-dsym-snapshot.zip
+7953214655b563394e46b516381eeccbe169b99321f26cc477c8f9b90e937fee *electron-v28.3.3-darwin-x64-dsym.zip
+56c20a5bea1665abb5c717ee98dd4791b63a4e319c4eaae69bed2a69adb0f39b *electron-v28.3.3-darwin-x64-symbols.zip
+6bc63916b7fe52de7559e7631fef5c93315a18ee90a0d3d08168c91414b09ecf *electron-v28.3.3-darwin-x64.zip
+77ce557574f9f8dacbb64b01e071c169d18fde2c51d7ee8c18e19c73ea617a72 *electron-v28.3.3-linux-arm64-debug.zip
+72ad5fdae67fde0f8c842e2fc041ad30180141c4646144f137cd4dbceb29d88f *electron-v28.3.3-linux-arm64-symbols.zip
+f77107266581a6b9880757876518df1c4bf6eeff5c193bb5de0a8f6c9902bd1f *electron-v28.3.3-linux-arm64.zip
+77ce557574f9f8dacbb64b01e071c169d18fde2c51d7ee8c18e19c73ea617a72 *electron-v28.3.3-linux-armv7l-debug.zip
+964a5ebe451679ccf703e082748c81301f89be42cf18981f0d547e59c3f8313b *electron-v28.3.3-linux-armv7l-symbols.zip
+384d8b43f52b5350a438031ad12980418fc244b4b0aecfa5f7dcc3d6f103ebed *electron-v28.3.3-linux-armv7l.zip
+d11fb190b8d737c3c9f44302f27adbe91dfdcf5355bf0502f36fb7b7941988c5 *electron-v28.3.3-linux-x64-debug.zip
+c9dac90edd66fa962c400b855ba518f3ce49f61223bcc332b848130ae7e5af35 *electron-v28.3.3-linux-x64-symbols.zip
+20f6be493cbd6c9924206e744b1c490af1f97f4735451b9dc19f0d305366d546 *electron-v28.3.3-linux-x64.zip
+865dc4f53dd6174fcc3da178f505fff0db04738f30c52b1b87e909f53be49585 *electron-v28.3.3-mas-arm64-dsym-snapshot.zip
+7f9323cd95662de4172dc66eb33cbe8a2b0a578c8edba95a571a2acbdaaee57e *electron-v28.3.3-mas-arm64-dsym.zip
+1df04dfae35660c9b7dae931eb3b74e748b19f61485e83c22b17a9379256a3eb *electron-v28.3.3-mas-arm64-symbols.zip
+6d8c25101238ad8f41cb5bc1fd780c945c01a2322cd370a2c0ee6cedb2c408c8 *electron-v28.3.3-mas-arm64.zip
+5b07b8ecbc045c877b94958f556cc69e971845309da973a3bd6c6846861f9658 *electron-v28.3.3-mas-x64-dsym-snapshot.zip
+acc72dd0b52be35a553caefd421b927088c6a7d6e969dab494b67af8d8400332 *electron-v28.3.3-mas-x64-dsym.zip
+70c8eac7c16789cd0d5e8cd14f07b0c73bab27f96efe323a7035f19feabfdde5 *electron-v28.3.3-mas-x64-symbols.zip
+72a083458fad09ce91bd3202270263d01da360f7f730e68974e48febaed95ac6 *electron-v28.3.3-mas-x64.zip
+ee4e0e895e4f0c6979dab69dfd72bc36458d6d58ae256fd7a66dfe7514c2b825 *electron-v28.3.3-win32-arm64-pdb.zip
+4d4d1aaf04d5747033f33735800a92684fe0dc8caa52d3c34a882e7c2d1d70f9 *electron-v28.3.3-win32-arm64-symbols.zip
+c9f31ae6408aa6936b5d683eda601773789185890375cd097e61e924d4fed77a *electron-v28.3.3-win32-arm64-toolchain-profile.zip
+be766cc3598e8a888770cff2949a0866abed18d441c11c7abf206856e0dd2c7d *electron-v28.3.3-win32-arm64.zip
+6dd6a972fea04be1da03d92844b1782f903537eae05234fccf1f2cfee86849bd *electron-v28.3.3-win32-ia32-pdb.zip
+22f2e5b6b83fc6bd8591afbf852759e230f1e5bd19ba9b450164ba33299d6ece *electron-v28.3.3-win32-ia32-symbols.zip
+c9f31ae6408aa6936b5d683eda601773789185890375cd097e61e924d4fed77a *electron-v28.3.3-win32-ia32-toolchain-profile.zip
+9d016b77e7034a236776208da5329a7ff21dc8a8eaf059722fade46ec69b4d64 *electron-v28.3.3-win32-ia32.zip
+5731598aff4d77d4006a7095d0b8f2df83beeb401c3dd8fe3f97f013bd33ceeb *electron-v28.3.3-win32-x64-pdb.zip
+e715521480ff466ee3e37d512aea19bf746d97e78e2e9fef8cf2d09eea2e663f *electron-v28.3.3-win32-x64-symbols.zip
+c9f31ae6408aa6936b5d683eda601773789185890375cd097e61e924d4fed77a *electron-v28.3.3-win32-x64-toolchain-profile.zip
+254c86fa6446df752f651955aa3eaba222469759f24bb3e7fd1f522d83cddb4a *electron-v28.3.3-win32-x64.zip
+7bad40dc76076678d55ac14ab5856aa608a84c1ae999434e80e1f70a5e3f6841 *electron.d.ts
+0d6d742cd3fc6d664d2894d7b8f75338a3b5563b2c0ea3d8b737e7cf15286ed2 *ffmpeg-v28.3.3-darwin-arm64.zip
+ec8343f766c9ead3915f94a377d934287f1d9efc27b6094556afd95410a430aa *ffmpeg-v28.3.3-darwin-x64.zip
+8e108e533811febcc51f377ac8604d506663453e41c02dc818517e1ea9a4e8d5 *ffmpeg-v28.3.3-linux-arm64.zip
+51ecd03435f56a2ced31b1c9dbf281955ba82a814ca0214a4292bdc711e5a45c *ffmpeg-v28.3.3-linux-armv7l.zip
+acc9dc3765f68b7563045e2d0df11bbef6b41be0a1c34bbf9fa778f36eefb42f *ffmpeg-v28.3.3-linux-x64.zip
+71307d74be6e5d9da253e69f731cc1b5ee17d72957f2f53600a80db2722e1944 *ffmpeg-v28.3.3-mas-arm64.zip
+46caea3583b5c12736a3a3e44e3c55353b234743d6a570e0f8feb0b4046ed43e *ffmpeg-v28.3.3-mas-x64.zip
+a867e5e334e2b77ae7bf6b82882532bb71d3da2a64057d31d7b0bae06e6f9c8e *ffmpeg-v28.3.3-win32-arm64.zip
+529befd18cf099e42efadab75587c37797de302d19762ac5c5ec0584cc3b0de9 *ffmpeg-v28.3.3-win32-ia32.zip
+3c5abc159ffb615290876370f8261e282b20992e0f1e72cccb9243d26d0b76f7 *ffmpeg-v28.3.3-win32-x64.zip
+24934acfa3a5b137e5081fc26be20cf2970949845551e2d66e74537230b2383c *hunspell_dictionaries.zip
+abc010611bc7bf51f7892c2107050af29076ac18da9d8ee16025119461b6f59d *libcxx-objects-v28.3.3-linux-arm64.zip
+733126da8217848ab369b0a0d96f2600e6bec5b6b48c3618c55a2a47bd6993e3 *libcxx-objects-v28.3.3-linux-armv7l.zip
+b515a6f32ee6737bdba0584898f507cfc81cdb971067014c6e44075267207dd7 *libcxx-objects-v28.3.3-linux-x64.zip
+8b1ad3108988a4d9d3ec17be1e7542f7910268d3924d2e624f85238fef2837ab *libcxx_headers.zip
+84366dd31ec3abeae1f0b6cc7beb0c2bb618a2a2763fe1898bf52e938e3a02ef *libcxxabi_headers.zip
+0e55a1df0d10db0ae8370d917c36200ccfcab1357fdbdf1655ecb12d0ad2d794 *mksnapshot-v28.3.3-darwin-arm64.zip
+4d47e024e8463661913a40f22f943aabdba46e5736cf8a7011b079e49e7fda55 *mksnapshot-v28.3.3-darwin-x64.zip
+9133011f453b98b35fa60cff0cc0d3918afb3cb9bc7b37447cf78406d36f5c90 *mksnapshot-v28.3.3-linux-arm64-x64.zip
+03f4bc2a52fba194b4aae2c549dd3eff595b0b90d71a4fb1f1d8b48e77777865 *mksnapshot-v28.3.3-linux-armv7l-x64.zip
+55caf274fdebd46652d7747efc80dcd0498d4e772e703571f5721be5019a2a46 *mksnapshot-v28.3.3-linux-x64.zip
+64f5c2ad45210dec8d1037dc3bc0d7682fff7ec8923d932e667efc4414af92b1 *mksnapshot-v28.3.3-mas-arm64.zip
+8c17f3ce0ab07b0f79935a15affa4a08c42c0c059ab551329fcc7e7f28c63236 *mksnapshot-v28.3.3-mas-x64.zip
+1299ab5a143d49eea89a72a037e2d4dfb6e4a50481b50e1bbca2bc02b37ece70 *mksnapshot-v28.3.3-win32-arm64-x64.zip
+f34fd3b76488ea3e3b0fafda4271126c2f403fdba9ed63bf0b34f1d9316897fb *mksnapshot-v28.3.3-win32-ia32.zip
+9956d87fac2043cbf9f445551622615a57b47b440e8fcd2ac211a82d94fd2e09 *mksnapshot-v28.3.3-win32-x64.zip
\ No newline at end of file
diff --git a/build/checksums/nodejs.txt b/build/checksums/nodejs.txt
index 3436ff3..8a14a69 100644
--- a/build/checksums/nodejs.txt
+++ b/build/checksums/nodejs.txt
@@ -1,7 +1,34 @@
-fc7355e778b181575153b7dea4879e8021776eeb376c43c50f65893d2ea70aa3  node-v20.16.0-darwin-arm64.tar.gz
-e18942cd706e4d69a4845ddacee2f1c17a72e853a229e3d2623d2edeb7efde72  node-v20.16.0-darwin-x64.tar.gz
-551588f8f5ca05c04efb53f1b2bb7d9834603327bdc82d60a944d385569866e1  node-v20.16.0-linux-arm64.tar.gz
-1c77c52ab507ddee479012f0b4bf523dd8400df4504447d623632353076e2e27  node-v20.16.0-linux-armv7l.tar.gz
-b3f874ea84e440d69ed02ca92429d0eccd17737fde86db69c1c153d16ec654f2  node-v20.16.0-linux-x64.tar.gz
-7e773fba3a19eac5ccbe85c1f87a05d7b112ecf41440076e6b6de1c7bffa0fdf  win-arm64/node.exe
-ba221658a3b68bd583e3068903eb675b5206d86a883c084ed95502e8f634b82a  win-x64/node.exe
+8911c72a1395cdf88b826da49e1dc0af9700c9db880a69da24a9e061769c94f2  node-v18.18.2-aix-ppc64.tar.gz
+9f982cc91b28778dd8638e4f94563b0c2a1da7aba62beb72bd427721035ab553  node-v18.18.2-darwin-arm64.tar.gz
+890bc7a53375ba53f0860796c88f3e8ada0d307df25ac25cf85140ffacbfb0bf  node-v18.18.2-darwin-arm64.tar.xz
+5bb8da908ed590e256a69bf2862238c8a67bc4600119f2f7721ca18a7c810c0f  node-v18.18.2-darwin-x64.tar.gz
+6492bc80eb736f2694e9e78f624c0a34c404d19b844a4f23b0e9a81bd515ebcc  node-v18.18.2-darwin-x64.tar.xz
+70c9164c1952a77ce06bd80e3507a11124cf60b6c82409e2c3ad1a6d5bc5a910  node-v18.18.2-headers.tar.gz
+c2c1298a1ccd1bfb2cb76725fb87715cf88db2a2515d28d8a66376300de96d67  node-v18.18.2-headers.tar.xz
+0c9a6502b66310cb26e12615b57304e91d92ac03d4adcb91c1906351d7928f0d  node-v18.18.2-linux-arm64.tar.gz
+2e630e18548627f61eaf573233da7949dc0a1df5eef3f486fa9820c5f6c121aa  node-v18.18.2-linux-arm64.tar.xz
+7a3b34a6fdb9514bc2374114ec6df3c36113dc5075c38b22763aa8f106783737  node-v18.18.2-linux-armv7l.tar.gz
+663160a8a2bbc42c9d2b2591d7dc556d245254f7c5e5aafb4adcad791ed39875  node-v18.18.2-linux-armv7l.tar.xz
+dbf0939c2ad50b74f2aaa005473b2e14c1cbe68318b69f4c1b4e6dda8e5aa43a  node-v18.18.2-linux-ppc64le.tar.gz
+b0adff5cf5938266b711d6c724fb134d802e0dee40b3a3f73d162de1b3d11880  node-v18.18.2-linux-ppc64le.tar.xz
+c5ed8da4272740190ce2a477096cb8486ade0d15e2b830f298d7d599c2e6cd97  node-v18.18.2-linux-s390x.tar.gz
+c70ec2074b5e2b42c55bb4b8105418b67bf8a61c500d9376a07430dfcc341fdb  node-v18.18.2-linux-s390x.tar.xz
+a44c3e7f8bf91e852c928e5d8bd67ca316b35e27eec1d8acbe3b9dbe03688dab  node-v18.18.2-linux-x64.tar.gz
+75aba25ae76999309fc6c598efe56ce53fbfc221381a44a840864276264ab8ac  node-v18.18.2-linux-x64.tar.xz
+01eba2502b9c60f20df0cd0a027d2eb6ea80c265e3cb05b2e14f14e5aedc025c  node-v18.18.2-win-x64.7z
+3bb0e51e579a41a22b3bf6cb2f3e79c03801aa17acbe0ca00fc555d1282e7acd  node-v18.18.2-win-x64.zip
+28422e9ebb45715e9744916299596519e80fc37680c06155b8e0108c7eb17974  node-v18.18.2-win-x86.7z
+1ba446246ac47e25f165b8a00d5245d68980d747bc5feffbc421d003dd186f14  node-v18.18.2-win-x86.zip
+221f2a904f13105122a108fb735a8f89615864c7bcba3842fa1ef684f136abe3  node-v18.18.2-x64.msi
+77684d746d977404ee1832505ae64fb4cb8355eb12e4bf37c3036f7cf3b84e5b  node-v18.18.2-x86.msi
+a7b27f8dbe7c73f357875a0e983ccab5ccc26f3e1e02cfc5c70404f3909d49dc  node-v18.18.2.pkg
+509cd2cfc3a515bf2257ed3886b9fac64aeaac2a70ea59c0a6e02e2dbb722132  node-v18.18.2.tar.gz
+7249e2f0af943ec38599504f4b2a2bd31fb938787291b6ccca6c8badf01e3b56  node-v18.18.2.tar.xz
+54884183ff5108874c091746465e8156ae0acc68af589cc10bc41b3927db0f4a  win-x64/node.exe
+57f0bf8dbc68fe3468105a7f9d8fe773220f135a171dde2682f30e118a6fc7d7  win-x64/node.lib
+f1fbe0be82f279f281336a9e8b29a5b41363d6f1d4aef88937d57c9fce985515  win-x64/node_pdb.7z
+07ce9bdc39f1a5dfd970837d1fc72c8461a010ed359f4dc12065ab917855d0cb  win-x64/node_pdb.zip
+a5226bb0dd7bbd7c33dad6456579a7da3e05a8f8bb0a2019296c556acae411e8  win-x86/node.exe
+62ee700c739ed89bfea9a5151be27c0ae035aa6dfb3efd7433076de1df389e35  win-x86/node.lib
+289e324c58377c086b4abf83096f4f2690427af20b1343d186808b6e4b2a356b  win-x86/node_pdb.7z
+021042696076e19e17ed67dc11bd2eee6eeccc7a3091bd070772b8b0630e8b34  win-x86/node_pdb.zip
diff --git a/build/lib/builtInExtensionsCG.js b/build/lib/builtInExtensionsCG.js
index 30b6791..df22f2d 100644
--- a/build/lib/builtInExtensionsCG.js
+++ b/build/lib/builtInExtensionsCG.js
@@ -4,6 +4,7 @@
  *  Licensed under the MIT License. See License.txt in the project root for license information.
  *--------------------------------------------------------------------------------------------*/
 Object.defineProperty(exports, "__esModule", { value: true });
+const node_fetch_1 = require("node-fetch");
 const fs = require("fs");
 const path = require("path");
 const url = require("url");
@@ -22,9 +23,9 @@ async function downloadExtensionDetails(extension) {
     const repositoryContentBaseUrl = `https://${token ? `${token}@` : ''}${contentBasePath}/${repository}/v${extension.version}`;
     async function getContent(fileName) {
         try {
-            const response = await fetch(`${repositoryContentBaseUrl}/${fileName}`);
+            const response = await (0, node_fetch_1.default)(`${repositoryContentBaseUrl}/${fileName}`);
             if (response.ok) {
-                return { fileName, body: Buffer.from(await response.arrayBuffer()) };
+                return { fileName, body: await response.buffer() };
             }
             else if (response.status === 404) {
                 return { fileName, body: undefined };
@@ -75,4 +76,4 @@ main().then(() => {
     console.error(err);
     process.exit(1);
 });
-//# sourceMappingURL=builtInExtensionsCG.js.map
\ No newline at end of file
+//# sourceMappingURL=builtInExtensionsCG.js.map
diff --git a/build/lib/builtInExtensionsCG.ts b/build/lib/builtInExtensionsCG.ts
index 62d0949..a84f431 100644
--- a/build/lib/builtInExtensionsCG.ts
+++ b/build/lib/builtInExtensionsCG.ts
@@ -3,6 +3,7 @@
  *  Licensed under the MIT License. See License.txt in the project root for license information.
  *--------------------------------------------------------------------------------------------*/
 
+import fetch from 'node-fetch';
 import * as fs from 'fs';
 import * as path from 'path';
 import * as url from 'url';
@@ -29,7 +30,7 @@ async function downloadExtensionDetails(extension: IExtensionDefinition): Promis
 		try {
 			const response = await fetch(`${repositoryContentBaseUrl}/${fileName}`);
 			if (response.ok) {
-				return { fileName, body: Buffer.from(await response.arrayBuffer()) };
+				return { fileName, body: await response.buffer() };
 			} else if (response.status === 404) {
 				return { fileName, body: undefined };
 			} else {
diff --git a/build/lib/compilation.ts b/build/lib/compilation.ts
index 978fb15..baca656 100644
--- a/build/lib/compilation.ts
+++ b/build/lib/compilation.ts
@@ -233,7 +233,7 @@ class MonacoGenerator {
 		}
 	}
 
-	private _executeSoonTimer: NodeJS.Timeout | null = null;
+	private _executeSoonTimer: NodeJS.Timer | null = null;
 	private _executeSoon(): void {
 		if (this._executeSoonTimer !== null) {
 			clearTimeout(this._executeSoonTimer);
diff --git a/build/lib/fetch.js b/build/lib/fetch.js
index b7da65f..42d6552 100644
--- a/build/lib/fetch.js
+++ b/build/lib/fetch.js
@@ -8,6 +8,7 @@ exports.fetchUrls = fetchUrls;
 exports.fetchUrl = fetchUrl;
 exports.fetchGithub = fetchGithub;
 const es = require("event-stream");
+const node_fetch_1 = require("node-fetch");
 const VinylFile = require("vinyl");
 const log = require("fancy-log");
 const ansiColors = require("ansi-colors");
@@ -43,7 +44,7 @@ async function fetchUrl(url, options, retries = 10, retryDelay = 1000) {
         const controller = new AbortController();
         const timeout = setTimeout(() => controller.abort(), 30 * 1000);
         try {
-            const response = await fetch(url, {
+            const response = await (0, node_fetch_1.default)(url, {
                 ...options.nodeFetchOptions,
                 signal: controller.signal /* Typings issue with lib.dom.d.ts */
             });
@@ -51,7 +52,7 @@ async function fetchUrl(url, options, retries = 10, retryDelay = 1000) {
                 log(`Fetch completed: Status ${response.status}. Took ${ansiColors.magenta(`${new Date().getTime() - startTime} ms`)}`);
             }
             if (response.ok && (response.status >= 200 && response.status < 300)) {
-                const contents = Buffer.from(await response.arrayBuffer());
+                const contents = await response.buffer();
                 if (options.checksumSha256) {
                     const actualSHA256Checksum = crypto.createHash('sha256').update(contents).digest('hex');
                     if (actualSHA256Checksum !== options.checksumSha256) {
@@ -135,4 +136,4 @@ function fetchGithub(repo, options) {
         }
     }));
 }
-//# sourceMappingURL=fetch.js.map
\ No newline at end of file
+//# sourceMappingURL=fetch.js.map
diff --git a/build/lib/fetch.ts b/build/lib/fetch.ts
index 0c44b8e..59456dc 100644
--- a/build/lib/fetch.ts
+++ b/build/lib/fetch.ts
@@ -4,6 +4,7 @@
  *--------------------------------------------------------------------------------------------*/
 
 import * as es from 'event-stream';
+import fetch, { RequestInit } from 'node-fetch';
 import * as VinylFile from 'vinyl';
 import * as log from 'fancy-log';
 import * as ansiColors from 'ansi-colors';
@@ -60,7 +61,7 @@ export async function fetchUrl(url: string, options: IFetchOptions, retries = 10
 				log(`Fetch completed: Status ${response.status}. Took ${ansiColors.magenta(`${new Date().getTime() - startTime} ms`)}`);
 			}
 			if (response.ok && (response.status >= 200 && response.status < 300)) {
-				const contents = Buffer.from(await response.arrayBuffer());
+				const contents = await response.buffer();
 				if (options.checksumSha256) {
 					const actualSHA256Checksum = crypto.createHash('sha256').update(contents).digest('hex');
 					if (actualSHA256Checksum !== options.checksumSha256) {
diff --git a/build/lib/policies.js b/build/lib/policies.js
index 466295b..2b9d8af 100644
--- a/build/lib/policies.js
+++ b/build/lib/policies.js
@@ -10,6 +10,7 @@ const path = require("path");
 const byline = require("byline");
 const ripgrep_1 = require("@vscode/ripgrep");
 const Parser = require("tree-sitter");
+const node_fetch_1 = require("node-fetch");
 const { typescript } = require('tree-sitter-typescript');
 const product = require('../../product.json');
 const packageJson = require('../../package.json');
@@ -425,7 +426,7 @@ async function getSpecificNLS(resourceUrlTemplate, languageId, version) {
         path: 'extension/translations/main.i18n.json'
     };
     const url = resourceUrlTemplate.replace(/\{([^}]+)\}/g, (_, key) => resource[key]);
-    const res = await fetch(url);
+    const res = await (0, node_fetch_1.default)(url);
     if (res.status !== 200) {
         throw new Error(`[${res.status}] Error downloading language pack ${languageId}@${version}`);
     }
@@ -446,7 +447,7 @@ function compareVersions(a, b) {
     return a[2] - b[2];
 }
 async function queryVersions(serviceUrl, languageId) {
-    const res = await fetch(`${serviceUrl}/extensionquery`, {
+    const res = await (0, node_fetch_1.default)(`${serviceUrl}/extensionquery`, {
         method: 'POST',
         headers: {
             'Accept': 'application/json;api-version=3.0-preview.1',
@@ -523,4 +524,4 @@ if (require.main === module) {
         process.exit(1);
     });
 }
-//# sourceMappingURL=policies.js.map
\ No newline at end of file
+//# sourceMappingURL=policies.js.map
diff --git a/build/lib/policies.ts b/build/lib/policies.ts
index 68f6989..0e89508 100644
--- a/build/lib/policies.ts
+++ b/build/lib/policies.ts
@@ -9,6 +9,7 @@ import * as path from 'path';
 import * as byline from 'byline';
 import { rgPath } from '@vscode/ripgrep';
 import * as Parser from 'tree-sitter';
+import fetch from 'node-fetch';
 const { typescript } = require('tree-sitter-typescript');
 const product = require('../../product.json');
 const packageJson = require('../../package.json');
diff --git a/build/linux/debian/install-sysroot.js b/build/linux/debian/install-sysroot.js
index feca7d3..5000b9b 100644
--- a/build/linux/debian/install-sysroot.js
+++ b/build/linux/debian/install-sysroot.js
@@ -11,6 +11,7 @@ const os_1 = require("os");
 const fs = require("fs");
 const https = require("https");
 const path = require("path");
+const fetch = require("node-fetch");
 const crypto_1 = require("crypto");
 const ansiColors = require("ansi-colors");
 // Based on https://source.chromium.org/chromium/chromium/src/+/main:build/linux/sysroot_scripts/install-sysroot.py.
@@ -214,4 +215,4 @@ async function getChromiumSysroot(arch) {
     fs.writeFileSync(stamp, url);
     return sysroot;
 }
-//# sourceMappingURL=install-sysroot.js.map
\ No newline at end of file
+//# sourceMappingURL=install-sysroot.js.map
diff --git a/build/linux/debian/install-sysroot.ts b/build/linux/debian/install-sysroot.ts
index aa417dc..b2e3689 100644
--- a/build/linux/debian/install-sysroot.ts
+++ b/build/linux/debian/install-sysroot.ts
@@ -8,6 +8,7 @@ import { tmpdir } from 'os';
 import * as fs from 'fs';
 import * as https from 'https';
 import * as path from 'path';
+import * as fetch from 'node-fetch';
 import { createHash } from 'crypto';
 import { DebianArchString } from './types';
 import * as ansiColors from 'ansi-colors';
diff --git a/build/npm/preinstall.js b/build/npm/preinstall.js
index b98f229..d9195d0 100644
--- a/build/npm/preinstall.js
+++ b/build/npm/preinstall.js
@@ -9,8 +9,8 @@ const minorNodeVersion = parseInt(nodeVersion[2]);
 const patchNodeVersion = parseInt(nodeVersion[3]);
 
 if (!process.env['VSCODE_SKIP_NODE_VERSION_CHECK']) {
-	if (majorNodeVersion < 20) {
-		console.error('\x1b[1;31m*** Please use latest Node.js v20 LTS for development.\x1b[0;0m');
+	if (majorNodeVersion < 18) {
+		console.error('\x1b[1;31m*** Please use Node.js v18 for development.\x1b[0;0m');
 		throw new Error();
 	}
 }
diff --git a/build/package.json b/build/package.json
index 7017b91..7a5804e 100644
--- a/build/package.json
+++ b/build/package.json
@@ -4,7 +4,7 @@
   "license": "MIT",
   "devDependencies": {
     "@azure/cosmos": "^3",
-    "@azure/identity": "^4.2.1",
+    "@azure/identity": "3.3.2",
     "@azure/storage-blob": "^12.17.0",
     "@electron/get": "^2.0.0",
     "@types/ansi-colors": "^3.2.0",
@@ -26,7 +26,7 @@
     "@types/minimatch": "^3.0.3",
     "@types/minimist": "^1.2.1",
     "@types/mocha": "^9.1.1",
-    "@types/node": "20.x",
+    "@types/node": "18.19.53",
     "@types/pump": "^1.0.1",
     "@types/rimraf": "^2.0.4",
     "@types/through": "^0.0.29",
@@ -41,12 +41,13 @@
     "commander": "^7.0.0",
     "debug": "^4.3.2",
     "electron-osx-sign": "^0.4.16",
-    "esbuild": "0.23.0",
+    "esbuild": "0.23.1",
     "extract-zip": "^2.0.1",
     "gulp-merge-json": "^2.1.1",
     "gulp-sort": "^2.0.0",
     "jsonc-parser": "^2.3.0",
     "mime": "^1.4.1",
+    "node-fetch": "2.7.0",
     "source-map": "0.6.1",
     "ternary-stream": "^3.0.0",
     "through2": "^4.0.2",
diff --git a/cgmanifest.json b/cgmanifest.json
index dcb4791..c79bfa0 100644
--- a/cgmanifest.json
+++ b/cgmanifest.json
@@ -6,7 +6,7 @@
 				"git": {
 					"name": "chromium",
 					"repositoryUrl": "https://chromium.googlesource.com/chromium/src",
-					"commitHash": "7fa4f6e14e0707c0e604cf7c1da33566e78169ce"
+					"commitHash": "14d11e5bb9b5b1cd51f7b19546e74a73cab42084"
 				}
 			},
 			"licenseDetail": [
@@ -40,7 +40,7 @@
 				"SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE."
 			],
 			"isOnlyProductionDependency": true,
-			"version": "124.0.6367.243"
+			"version": "120.0.6099.291"
 		},
 		{
 			"component": {
@@ -48,7 +48,7 @@
 				"git": {
 					"name": "ffmpeg",
 					"repositoryUrl": "https://chromium.googlesource.com/chromium/third_party/ffmpeg",
-					"commitHash": "52d8ef3799b2f16b66351dd0972bb0bcee1648ac"
+					"commitHash": "e1ca3f06adec15150a171bc38f550058b4bbb23b"
 				}
 			},
 			"isOnlyProductionDependency": true,
@@ -516,11 +516,11 @@
 				"git": {
 					"name": "nodejs",
 					"repositoryUrl": "https://github.com/nodejs/node",
-					"commitHash": "1968ef32415607643770efb320d7d4e941baaa25"
+					"commitHash": "8a01b3dcb7d08a48bfd3e6bf85ef49faa1454839"
 				}
 			},
 			"isOnlyProductionDependency": true,
-			"version": "20.16.0"
+			"version": "18.18.2"
 		},
 		{
 			"component": {
@@ -528,12 +528,12 @@
 				"git": {
 					"name": "electron",
 					"repositoryUrl": "https://github.com/electron/electron",
-					"commitHash": "a07a70e8db21718dd76644d99892d3e15e0ed440"
+					"commitHash": "92e4123de76879f438b69d3185a00ffb359176b7"
 				}
 			},
 			"isOnlyProductionDependency": true,
 			"license": "MIT",
-			"version": "30.5.1"
+			"version": "28.3.3"
 		},
 		{
 			"component": {
diff --git a/extensions/package.json b/extensions/package.json
index c918c19..10b6b86 100644
--- a/extensions/package.json
+++ b/extensions/package.json
@@ -11,7 +11,7 @@
   },
   "devDependencies": {
     "@parcel/watcher": "2.1.0",
-    "esbuild": "0.23.0",
+    "esbuild": "0.23.1",
     "vscode-grammar-updater": "^1.1.0"
   },
   "resolutions": {
diff --git a/package.json b/package.json
index 7e0de18..861cc06 100644
--- a/package.json
+++ b/package.json
@@ -115,7 +115,7 @@
     "yazl": "^2.4.3"
   },
   "devDependencies": {
-    "@playwright/test": "^1.46.1",
+    "@playwright/test": "1.45.1",
     "@swc/core": "1.3.62",
     "@types/cookie": "^0.3.3",
     "@types/debug": "^4.1.5",
@@ -124,9 +124,9 @@
     "@types/kerberos": "^1.1.2",
     "@types/minimist": "^1.2.1",
     "@types/mocha": "^9.1.1",
-    "@types/node": "20.x",
-    "@types/sinon": "^10.0.2",
-    "@types/sinon-test": "^2.4.2",
+    "@types/node": "18.19.53",
+    "@types/sinon": "10.0.16",
+    "@types/sinon-test": "2.4.6",
     "@types/trusted-types": "^1.0.6",
     "@types/vscode-notebook-renderer": "^1.72.0",
     "@types/webpack": "^5.28.5",
@@ -138,12 +138,12 @@
     "@typescript-eslint/eslint-plugin": "^6.21.0",
     "@typescript-eslint/experimental-utils": "^5.57.0",
     "@typescript-eslint/parser": "^6.21.0",
-    "@vscode/gulp-electron": "^1.36.0",
-    "@vscode/l10n-dev": "0.0.35",
+    "@vscode/gulp-electron": "git+https://github.com/Alex313031/vscode-gulp-electron.git",
+    "@vscode/l10n-dev": "0.0.35",
     "@vscode/telemetry-extractor": "^1.10.2",
     "@vscode/test-cli": "^0.0.6",
     "@vscode/test-electron": "^2.4.0",
-    "@vscode/test-web": "^0.0.60",
+    "@vscode/test-web": "0.0.56",
     "@vscode/v8-heap-parser": "^0.1.0",
     "@vscode/vscode-perf": "^0.0.14",
     "@webgpu/types": "^0.1.44",
@@ -156,7 +156,7 @@
     "cssnano": "^6.0.3",
     "debounce": "^1.0.0",
     "deemon": "^1.8.0",
-    "electron": "30.5.1",
+    "electron": "28.3.3",
     "eslint": "8.36.0",
     "eslint-plugin-header": "3.1.1",
     "eslint-plugin-jsdoc": "^46.5.0",
@@ -205,10 +205,10 @@
     "postcss": "^8.4.33",
     "postcss-nesting": "^12.0.2",
     "pump": "^1.0.1",
-    "rcedit": "^1.1.0",
+    "rcedit": "^1.1.2",
     "rimraf": "^2.2.8",
-    "sinon": "^12.0.1",
-    "sinon-test": "^3.1.3",
+    "sinon": "12.0.1",
+    "sinon-test": "3.1.5",
     "source-map": "0.6.1",
     "source-map-support": "^0.3.2",
     "style-loader": "^3.3.2",
diff --git a/remote/.npmrc b/remote/.npmrc
index d6905a0..cedd548 100644
--- a/remote/.npmrc
+++ b/remote/.npmrc
@@ -1,5 +1,5 @@
 disturl="https://nodejs.org/dist"
-target="20.16.0"
+target="18.18.2"
 ms_build_id="289487"
 runtime="node"
 build_from_source="true"
diff --git a/src/vs/server/node/remoteExtensionHostAgentServer.ts b/src/vs/server/node/remoteExtensionHostAgentServer.ts
index c076b5c..f315a2e 100644
--- a/src/vs/server/node/remoteExtensionHostAgentServer.ts
+++ b/src/vs/server/node/remoteExtensionHostAgentServer.ts
@@ -556,8 +556,7 @@ class RemoteExtensionHostAgentServer extends Disposable implements IServerAPI {
 			const socket = net.createConnection(
 				{
 					host: host,
-					port: port,
-					autoSelectFamily: true
+					port: port
 				}, () => {
 					socket.removeListener('error', e);
 					socket.pause();
diff --git a/src/vs/workbench/api/node/extHostExtensionService.ts b/src/vs/workbench/api/node/extHostExtensionService.ts
index 51e767f..89b00c2 100644
--- a/src/vs/workbench/api/node/extHostExtensionService.ts
+++ b/src/vs/workbench/api/node/extHostExtensionService.ts
@@ -18,11 +18,16 @@ import { CLIServer } from './extHostCLIServer.js';
 import { realpathSync } from '../../../base/node/extpath.js';
 import { ExtHostConsoleForwarder } from './extHostConsoleForwarder.js';
 import { ExtHostDiskFileSystemProvider } from './extHostDiskFileSystemProvider.js';
+import path from 'path';
+import { fileURLToPath } from 'url';
 // ESM-uncomment-begin
 import { createRequire } from 'node:module';
 const require = createRequire(import.meta.url);
 // ESM-uncomment-end
 
+const __filename = fileURLToPath(import.meta.url);
+const __dirname = path.dirname(__filename);
+
 class NodeModuleRequireInterceptor extends RequireInterceptor {
 
 	protected _installInterceptor(): void {
@@ -54,7 +59,7 @@ class NodeModuleRequireInterceptor extends RequireInterceptor {
 				// Some extensions have been using `require.resolve('vsda', { paths: require.main.paths })`
 				// to find the `vsda` module in our app root. To be backwards compatible with this pattern,
 				// we help by filling in the `paths` array with the node modules paths of the current module.
-				options.paths = node_module._nodeModulePaths(import.meta.dirname);
+				options.paths = node_module._nodeModulePaths(__dirname);
 			}
 			return originalResolveFilename.call(this, request, parent, isMain, options);
 		};
